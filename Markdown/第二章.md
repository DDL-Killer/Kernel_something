# 第二章

* 8086计算机开机时，cpu的cs:ip寄存器被强制转化为0xF000:0xFFF00
* 开机时处于实模式，实模式下的段基址要乘16，也就是左移4位
* 由于cpu访问的内存是：段地址+偏移地址，所以访问的地址是0xF000*16+0xFFF0=0xFFFF0
* mbr（512字节，最后两个字节0x55，0xaa，如果是，则加载扇区内容到0x7c00内存）的任务就是加载loader，由loader加载操作系统到指定位置，然后执行加载过来的操作系统
* 必须是512字节的原因是为了占满512字节

## 代码mbr.S

1. 代码功能

   显示几个字符

2. 实现原理

   用8086汇编语言编写显示字符的程序，共512个字节，不足补0，用nasm编译后，用dd命令写入bochs启动硬盘的0盘0道1扇区

3. 代码逻辑

   * 清屏
   * 获取光标位置
   * 在光标位置处打印字符串

4. 怎么写

   1. 指定起始地址0x7c00——让编译器把本程序的起始地址编译为0x7c00
   2. 调用bios中断清屏
   3. 调用bios中断获取光标位置
   4. 调用bios中断获取打印字符
   5. 死循环，填入mbr规定510字节大小剩下的0，固定结尾两字节0x55，0xaa